import{c as S,r as m,j as e,u as D,X as O}from"./index-DSw6rzZA.js";import{u as v}from"./workoutStore-bGkCovhU.js";import{C as H,P as E,T as K}from"./Tabs-CBJDpFuU.js";import{C}from"./Card-J2pKyY-r.js";import{B as b,M as A,A as I,I as k}from"./Input-5INKq-7_.js";import{E as W,B as $,u as U,S as V}from"./catalogStore-DmW5UPxm.js";import{g as T,k as z,f as B,a as F,b as q,c as G}from"./index-DCNarqpm.js";import{u as L}from"./settingsStore-BT_5zqJA.js";import{T as _}from"./trash-2-_CTqjij1.js";import"./index-CKQLG8D-.js";const Y=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],X=S("chevron-down",Y);const J=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Q=S("chevron-up",J);const Z=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],ee=S("pen",Z);const te=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],se=S("play",te);const ae=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],ne=S("settings-2",ae);function le({onStarted:a}){const{plans:t,loadPlans:d,startSession:u,getPreviousSession:i}=v(),[r,l]=m.useState(null);m.useEffect(()=>{d()},[d]);const s=t.find(n=>n.id===r),o=t.filter(n=>n.days.length>0),c=async n=>{if(!s)return;const j=s.days.find(p=>p.id===n);if(!j)return;const g=i(s.id,n),N=j.exercises.map(p=>{const x=g?.exercises.find(w=>w.exerciseId===p.exerciseId),y=Array.from({length:p.sets},(w,h)=>({id:T(),setNumber:h+1,weight:x?.sets[h]?.weight??0,reps:x?.sets[h]?.reps??0,isCompleted:!1,isPR:!1}));return{id:T(),exerciseId:p.exerciseId,exerciseName:p.exerciseName,sets:y}});await u(s.id,n,j.name,N),a()};return o.length===0?e.jsx(W,{title:"No workout plans",description:"Create a plan with at least one day to start working out"}):r?e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("button",{onClick:()=>l(null),className:"text-sm text-text-secondary hover:text-text-primary self-start transition-colors",children:"← Back to Plans"}),e.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:s?.name}),s?.days.map(n=>e.jsxs(C,{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-text-primary",children:n.name}),e.jsxs("p",{className:"text-xs text-text-muted",children:[n.exercises.length," exercise",n.exercises.length!==1?"s":""]})]}),e.jsxs(b,{onClick:()=>c(n.id),className:"flex items-center gap-1.5 text-sm",children:[e.jsx(se,{size:14}),"Start"]})]},n.id))]}):e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Select a Plan"}),o.map(n=>e.jsxs(C,{className:"cursor-pointer hover:bg-surface-alt transition-colors",onClick:()=>l(n.id),children:[e.jsx("p",{className:"text-sm font-semibold text-text-primary",children:n.name}),e.jsxs("p",{className:"text-xs text-text-muted",children:[n.days.length," day",n.days.length!==1?"s":""]})]},n.id))]})}const re=m.memo(function({set:t,previousSet:d,onWeightChange:u,onRepsChange:i,onComplete:r}){const l=L(o=>o.units),s=d?`${l==="lbs"?z(d.weight):d.weight}${l} × ${d.reps}`:"—";return e.jsxs("div",{className:`flex items-center gap-2 py-1.5 ${t.isCompleted?"bg-surface-alt/50 rounded-lg px-2 -mx-2":""}`,children:[e.jsx("span",{className:"text-xs text-text-muted w-6 text-center shrink-0",children:t.setNumber}),e.jsx("span",{className:"text-xs text-text-muted w-20 text-center shrink-0",children:s}),e.jsx("input",{type:"number",inputMode:"decimal",value:t.weight||"",onChange:o=>u(Number(o.target.value)),placeholder:l,className:"w-[60px] bg-surface-alt border border-border-default rounded-lg px-2 py-1.5 text-sm text-text-primary text-center placeholder:text-text-muted focus:border-accent focus:outline-none"}),e.jsx("input",{type:"number",inputMode:"numeric",value:t.reps||"",onChange:o=>i(Number(o.target.value)),placeholder:"reps",className:"w-12 bg-surface-alt border border-border-default rounded-lg px-2 py-1.5 text-sm text-text-primary text-center placeholder:text-text-muted focus:border-accent focus:outline-none"}),e.jsx("button",{onClick:r,className:`p-1.5 rounded-lg transition-colors shrink-0 ${t.isCompleted?"bg-success text-black":"bg-surface-alt text-text-muted hover:text-text-primary"}`,"aria-label":t.isCompleted?"Mark set incomplete":"Mark set complete",children:e.jsx(H,{size:14})}),t.isPR&&e.jsx($,{variant:"success",className:"shrink-0",children:"PR"})]})});function ie({exercise:a,exerciseIndex:t,previousExercise:d}){const{updateSet:u,addSet:i,completeSet:r}=v();return e.jsxs(C,{className:"flex flex-col gap-2",children:[e.jsx("p",{className:"text-sm font-semibold text-text-primary",children:a.exerciseName}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-text-muted",children:[e.jsx("span",{className:"w-6 text-center",children:"Set"}),e.jsx("span",{className:"w-20 text-center",children:"Previous"}),e.jsx("span",{className:"w-[60px] text-center",children:"kg"}),e.jsx("span",{className:"w-12 text-center",children:"Reps"}),e.jsx("span",{className:"w-8"})]}),a.sets.map((l,s)=>e.jsx(re,{set:l,previousSet:d?.sets[s],onWeightChange:o=>u(t,s,{weight:o}),onRepsChange:o=>u(t,s,{reps:o}),onComplete:()=>r(t,s)},l.id)),e.jsxs("button",{onClick:()=>i(t),className:"flex items-center gap-1 text-xs text-text-secondary hover:text-text-primary transition-colors py-1 self-start",children:[e.jsx(E,{size:12}),"Add Set"]})]})}function P({isOpen:a,onClose:t,onConfirm:d,title:u,message:i,confirmLabel:r="Confirm",variant:l="primary"}){return e.jsxs(A,{isOpen:a,onClose:t,title:u,children:[e.jsx("p",{className:"text-sm text-text-secondary mb-6",children:i}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(b,{variant:"ghost",onClick:t,children:"Cancel"}),e.jsx(b,{variant:l==="destructive"?"destructive":"primary",onClick:()=>{d(),t()},children:r})]})]})}function ce({onFinished:a}){const{activeSession:t,finishSession:d,cancelSession:u,getPreviousSession:i}=v(),{showToast:r}=D(),[l,s]=m.useState("00:00:00"),[o,c]=m.useState(!1),[n,j]=m.useState(!1);if(m.useEffect(()=>{if(!t)return;const x=new Date(t.startedAt).getTime(),y=setInterval(()=>{s(B(x,Date.now()))},1e3);return()=>clearInterval(y)},[t]),!t)return null;const g=i(t.planId,t.dayId),N=async()=>{await d(),r("Workout completed!","success"),a()},p=()=>{u(),a()};return e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:t.dayName}),e.jsx("p",{className:"text-2xl font-bold text-accent font-mono",children:l})]}),e.jsx("button",{onClick:()=>j(!0),className:"text-sm text-text-muted hover:text-destructive transition-colors",children:"Cancel"})]}),t.exercises.map((x,y)=>e.jsx(ie,{exercise:x,exerciseIndex:y,previousExercise:g?.exercises.find(w=>w.exerciseId===x.exerciseId)},x.id)),e.jsx(b,{onClick:()=>c(!0),className:"w-full text-base py-3",children:"Finish Workout"}),e.jsx(P,{isOpen:o,onClose:()=>c(!1),onConfirm:N,title:"Finish Workout",message:"Save this workout session?",confirmLabel:"Finish"}),e.jsx(P,{isOpen:n,onClose:()=>j(!1),onConfirm:p,title:"Cancel Workout",message:"Are you sure? Your progress will be lost.",confirmLabel:"Cancel Workout",variant:"destructive"})]})}function oe({session:a,onBack:t}){const d=L(i=>i.units),u=a.completedAt?B(new Date(a.startedAt).getTime(),new Date(a.completedAt).getTime()):"—";return e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("button",{onClick:t,className:"flex items-center gap-2 text-text-secondary hover:text-text-primary transition-colors self-start","aria-label":"Go back",children:[e.jsx(I,{size:18}),e.jsx("span",{className:"text-sm",children:"Back"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:a.dayName}),e.jsxs("p",{className:"text-xs text-text-muted",children:[F(new Date(a.startedAt))," · ",u]})]}),a.exercises.map(i=>e.jsxs(C,{children:[e.jsx("p",{className:"text-sm font-semibold text-text-primary mb-2",children:i.exerciseName}),e.jsx("div",{className:"flex flex-col gap-1",children:i.sets.filter(r=>r.isCompleted).map(r=>{const l=d==="lbs"?z(r.weight):r.weight;return e.jsxs("div",{className:"flex items-center gap-2 text-sm text-text-secondary",children:[e.jsxs("span",{className:"text-text-muted w-6",children:["#",r.setNumber]}),e.jsxs("span",{children:[l," ",d," × ",r.reps," reps"]}),r.isPR&&e.jsx($,{variant:"success",children:"PR"})]},r.id)})})]},i.id))]})}function xe(){const{sessions:a,loadSessions:t}=v(),d=L(s=>s.units),[u,i]=m.useState(null);if(m.useEffect(()=>{t()},[t]),u)return e.jsx(oe,{session:u,onBack:()=>i(null)});const r=a.filter(s=>s.completedAt!==null);if(r.length===0)return e.jsx(W,{title:"No workout history",description:"Complete a workout to see it here"});const l={};for(const s of r){const o=new Date(s.startedAt),c=`${o.getFullYear()}-W${q(o)}`;l[c]||(l[c]=[]),l[c].push(s)}return e.jsx("div",{className:"flex flex-col gap-4",children:Object.entries(l).map(([s,o])=>e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("h4",{className:"text-xs font-medium text-text-muted uppercase",children:["Week ",s.split("-W")[1],", ",s.split("-")[0]]}),o.map(c=>{const n=c.exercises.reduce((g,N)=>g+N.sets.filter(p=>p.isCompleted).reduce((p,x)=>p+G(x.weight,x.reps,1),0),0),j=d==="lbs"?z(n):n;return e.jsx(C,{className:"cursor-pointer hover:bg-surface-alt transition-colors",onClick:()=>i(c),children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-text-primary",children:c.dayName}),e.jsx("p",{className:"text-xs text-text-muted",children:F(new Date(c.startedAt))})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-xs text-text-muted",children:[c.exercises.length," exercises"]}),e.jsxs("p",{className:"text-xs text-text-secondary",children:[Math.round(j).toLocaleString()," ",d]})]})]})},c.id)})]},s))})}function de({planId:a,dayId:t,onClose:d}){const{exercises:u,loadExercises:i}=U(),{addExerciseToDay:r}=v(),{showToast:l}=D(),[s,o]=m.useState(""),[c,n]=m.useState(null),[j,g]=m.useState(3),[N,p]=m.useState(8),[x,y]=m.useState(12);m.useEffect(()=>{i()},[i]);const w=u.filter(f=>!s||f.name.toLowerCase().includes(s.toLowerCase())||f.primaryMuscles.some(M=>M.toLowerCase().includes(s.toLowerCase()))),h=async()=>{if(!c)return;const M=v.getState().plans.find(R=>R.id===a)?.days.find(R=>R.id===t);await r(a,t,{id:T(),exerciseId:c.id,exerciseName:c.name,sets:j,repRangeMin:N,repRangeMax:x,order:M?.exercises.length??0}),l(`Added ${c.name}`,"success"),d()};return e.jsx(A,{isOpen:!0,onClose:d,title:c?"Configure Exercise":"Add Exercise",children:c?e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("p",{className:"text-sm font-semibold text-text-primary",children:c.name}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"flex-1",children:e.jsx(k,{label:"Sets",type:"number",min:1,max:10,value:j,onChange:f=>g(Number(f.target.value))})}),e.jsx("div",{className:"flex-1",children:e.jsx(k,{label:"Min Reps",type:"number",min:1,max:100,value:N,onChange:f=>p(Number(f.target.value))})}),e.jsx("div",{className:"flex-1",children:e.jsx(k,{label:"Max Reps",type:"number",min:1,max:100,value:x,onChange:f=>y(Number(f.target.value))})})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(b,{variant:"ghost",onClick:()=>n(null),className:"flex-1",children:"Back"}),e.jsx(b,{onClick:h,className:"flex-1",children:"Add"})]})]}):e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(V,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-text-muted"}),e.jsx("input",{type:"text",placeholder:"Search exercises...",value:s,onChange:f=>o(f.target.value),className:"w-full bg-surface-alt border border-border-default rounded-lg pl-9 pr-3 py-2 text-sm text-text-primary placeholder:text-text-muted focus:border-accent focus:outline-none"})]}),e.jsx("div",{className:"max-h-64 overflow-y-auto flex flex-col gap-1",children:w.map(f=>e.jsxs("button",{onClick:()=>n(f),className:"w-full text-left px-3 py-2 rounded-lg hover:bg-surface-alt transition-colors",children:[e.jsx("p",{className:"text-sm text-text-primary",children:f.name}),e.jsxs("p",{className:"text-xs text-text-muted",children:[f.category," · ",f.equipment]})]},f.id))})]})})}function me({planId:a,day:t,onRemove:d}){const{removeExerciseFromDay:u}=v(),[i,r]=m.useState(!0),[l,s]=m.useState(!1),[o,c]=m.useState(!1);return e.jsxs(C,{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("button",{onClick:()=>r(!i),className:"flex items-center gap-2 text-text-primary font-semibold text-sm",children:[i?e.jsx(Q,{size:16}):e.jsx(X,{size:16}),t.name,e.jsxs("span",{className:"text-text-muted font-normal",children:["(",t.exercises.length," exercises)"]})]}),e.jsx("button",{onClick:()=>c(!0),className:"text-text-muted hover:text-destructive p-1 transition-colors","aria-label":"Remove day",children:e.jsx(O,{size:16})})]}),i&&e.jsxs("div",{className:"flex flex-col gap-2",children:[t.exercises.map(n=>e.jsxs("div",{className:"flex items-center justify-between bg-surface-alt rounded-lg px-3 py-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-text-primary",children:n.exerciseName}),e.jsxs("p",{className:"text-xs text-text-muted",children:[n.sets," × ",n.repRangeMin,"-",n.repRangeMax," reps"]})]}),e.jsx("button",{onClick:()=>u(a,t.id,n.id),className:"text-text-muted hover:text-destructive p-1 transition-colors","aria-label":"Remove exercise",children:e.jsx(_,{size:14})})]},n.id)),e.jsxs("button",{onClick:()=>s(!0),className:"flex items-center gap-1.5 text-sm text-text-secondary hover:text-text-primary transition-colors py-1",children:[e.jsx(E,{size:14}),"Add Exercise"]})]}),l&&e.jsx(de,{planId:a,dayId:t.id,onClose:()=>s(!1)}),e.jsx(P,{isOpen:o,onClose:()=>c(!1),onConfirm:d,title:"Remove Day",message:`Remove "${t.name}" from this plan?`,confirmLabel:"Remove",variant:"destructive"})]})}function ue({plan:a,onBack:t}){const{updatePlan:d,addDayToPlan:u,removeDayFromPlan:i}=v(),{showToast:r}=D(),[l,s]=m.useState(!1),[o,c]=m.useState(""),[n,j]=m.useState(!1),[g,N]=m.useState(a.name),p=async()=>{g.trim()&&g!==a.name&&await d({...a,name:g.trim()}),j(!1)},x=async()=>{o.trim()&&(await u(a.id,o.trim()),c(""),s(!1),r("Day added","success"))},y=async h=>{await i(a.id,h),r("Day removed","success")},w=v(h=>h.plans.find(f=>f.id===a.id))||a;return e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("button",{onClick:t,className:"flex items-center gap-2 text-text-secondary hover:text-text-primary transition-colors self-start","aria-label":"Go back",children:[e.jsx(I,{size:18}),e.jsx("span",{className:"text-sm",children:"Back to Plans"})]}),e.jsx("div",{className:"flex items-center gap-2",children:n?e.jsx(k,{value:g,onChange:h=>N(h.target.value),onBlur:p,onKeyDown:h=>h.key==="Enter"&&p(),className:"text-lg font-bold",autoFocus:!0}):e.jsx("button",{onClick:()=>j(!0),className:"text-2xl font-bold text-text-primary hover:text-accent transition-colors",children:w.name})}),w.days.map(h=>e.jsx(me,{planId:w.id,day:h,onRemove:()=>y(h.id)},h.id)),e.jsxs(b,{onClick:()=>s(!0),variant:"ghost",className:"flex items-center gap-1.5 self-start",children:[e.jsx(E,{size:16}),"Add Day"]}),e.jsx(A,{isOpen:l,onClose:()=>s(!1),title:"Add Workout Day",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx(k,{label:"Day Name",placeholder:"e.g. Upper A, Lower B",value:o,onChange:h=>c(h.target.value),onKeyDown:h=>h.key==="Enter"&&x()}),e.jsx(b,{onClick:x,disabled:!o.trim(),className:"w-full",children:"Add Day"})]})})]})}function he(){const{plans:a,loadPlans:t,createPlan:d,deletePlan:u}=v(),{showToast:i}=D(),[r,l]=m.useState(!1),[s,o]=m.useState(""),[c,n]=m.useState(null),[j,g]=m.useState(null);m.useEffect(()=>{t()},[t]);const N=async()=>{s.trim()&&(await d(s.trim()),o(""),l(!1),i("Plan created","success"))},p=async()=>{j&&(await u(j),g(null),i("Plan deleted","success"))};if(c){const x=a.find(y=>y.id===c);if(x)return e.jsx(ue,{plan:x,onBack:()=>n(null)})}return e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"My Plans"}),e.jsxs(b,{onClick:()=>l(!0),className:"flex items-center gap-1.5 text-sm",children:[e.jsx(E,{size:16}),"New Plan"]})]}),a.length===0?e.jsx(W,{title:"No workout plans",description:"Create your first plan to get started"}):a.map(x=>e.jsxs(C,{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-text-primary",children:x.name}),e.jsxs("p",{className:"text-xs text-text-muted",children:[x.days.length," day",x.days.length!==1?"s":""]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>n(x.id),className:"text-text-muted hover:text-text-primary p-2 transition-colors","aria-label":"Edit plan",children:e.jsx(ee,{size:16})}),e.jsx("button",{onClick:()=>g(x.id),className:"text-text-muted hover:text-destructive p-2 transition-colors","aria-label":"Delete plan",children:e.jsx(_,{size:16})})]})]},x.id)),e.jsx(A,{isOpen:r,onClose:()=>l(!1),title:"New Workout Plan",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx(k,{label:"Plan Name",placeholder:"e.g. Upper Lower Split",value:s,onChange:x=>o(x.target.value),onKeyDown:x=>x.key==="Enter"&&N()}),e.jsx(b,{onClick:N,disabled:!s.trim(),className:"w-full",children:"Create Plan"})]})}),e.jsx(P,{isOpen:!!j,onClose:()=>g(null),onConfirm:p,title:"Delete Plan",message:"Are you sure you want to delete this plan? This cannot be undone.",confirmLabel:"Delete",variant:"destructive"})]})}const pe=[{id:"workout",label:"Workout"},{id:"history",label:"History"}];function Se(){const a=v(s=>s.activeSession),[t,d]=m.useState("workout"),[u,i]=m.useState(!1),[r,l]=m.useState(!1);return a?e.jsx("div",{className:"p-4",children:e.jsx(ce,{onFinished:()=>l(!1)})}):e.jsxs("div",{className:"p-4 flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-text-primary",children:"Workouts"}),e.jsx("button",{onClick:()=>{i(!u),l(!1)},className:"text-text-muted hover:text-text-primary p-2 transition-colors","aria-label":"Manage plans",children:e.jsx(ne,{size:20})})]}),u?e.jsx(he,{}):e.jsxs(e.Fragment,{children:[e.jsx(K,{tabs:pe,activeTab:t,onTabChange:d}),t==="workout"&&(r?e.jsx(le,{onStarted:()=>l(!1)}):e.jsxs("div",{className:"flex flex-col items-center gap-4 py-8",children:[e.jsx(b,{onClick:()=>l(!0),className:"text-base px-8 py-3",children:"Start Workout"}),e.jsx("p",{className:"text-xs text-text-muted",children:"Select a plan and day to begin"})]})),t==="history"&&e.jsx(xe,{})]})]})}export{Se as default};
